(function(){function r(t,n){n&&f.tagList.length&&t.childNodes.length&&f.query(t,f.tagList).forEach(function(e){r(e)}),f.tagCheck(t)&&(f.extendElement(t),e.documentElement.contains(t)&&f.getOptions(t).onInsert.call(t))}function o(e,t,n){switch(f.typeOf(n)){case"object":f.typeOf(e[t])=="object"?f.merge(e[t],n):e[t]=f.clone(n);break;case"array":e[t]=f.toArray(n);break;default:e[t]=n}return e}function h(){f.observe(e.documentElement,r),f.tagList.length&&f.query(e,f.tagList).forEach(function(e){r(e)}),f.domready=!0,f.fireEvent(e,"DOMComponentsLoaded"),f.fireEvent(e,"__DOMComponentsLoaded__")}var e=document,t=window,n=e.getElementsByTagName("head")[0],s=function(){var n=t.getComputedStyle(e.documentElement,""),r=(Array.prototype.slice.call(n).join("").match(/moz|webkit|ms/)||n.OLink===""&&["o"])[0],i="WebKit|Moz|MS|O".match(new RegExp("("+r+")","i"))[1];return{dom:i,lowercase:r,css:"-"+r+"-",js:r[0].toUpperCase()+r.substr(1)}}(),u={listener:function(e,t,n){!!~e.value.match(/(\d+)/g).indexOf(String(n[0].keyCode))==(e.name=="keypass")&&(n.splice(n.length,0,this),t.apply(this,n))}},a={mouseenter:"touchenter",mouseleave:"touchleave",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend",click:"touchend"},f={tags:{},tagList:[],callbacks:{},prefix:s,anchor:e.createElement("a"),mutation:t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver,_matchSelector:document.documentElement.matchesSelector||document.documentElement.mozMatchesSelector||document.documentElement.webkitMatchesSelector,tagOptions:{content:"",mixins:[],events:{},methods:{},getters:{},setters:{},onCreate:function(){},onInsert:function(){}},eventMap:{animationstart:["animationstart","oAnimationStart","MSAnimationStart","webkitAnimationStart"],transitionend:["transitionend","oTransitionEnd","MSTransitionEnd","webkitTransitionEnd"],tap:["ontouchend"in e?"touchend":"mouseup"]},pseudos:{delegate:{listener:function(e,t,n){var r=f.query(this,e.value).filter(function(e){return e==n[0].target||e.contains?e.contains(n[0].target):!1})[0];return r?t.apply(r,n):!1}},preventable:{listener:function(e,t,n){n[0].defaultPrevented||t.apply(this,n)}},attribute:{onAdd:function(e){this.xtag.attributeSetters=this.xtag.attributeSetters||{},this.xtag.attributeSetters[e.value]=e.key.split(":")[0]},listener:function(e,t,n){t.call(this,n[0]),this.setAttribute(e.value,n[0],!0)}},touch:{onAdd:function(e,t){this.addEventListener(a[e.key.split(":")[0]],t,!1)},listener:function(e,t,n){t.touched&&n[0].type.match("mouse")?t.touched=!1:(n[0].type.match("touch")&&(t.touched=!0),n.splice(n.length,0,this),t.apply(this,n))},onRemove:function(e,t){this.removeEventListener(a[e.key.split(":")[0]],t)}},keystop:u,keypass:u},mixins:{request:{onInsert:function(){this.src=this.getAttribute("src")},getters:{dataready:function(){return this.xtag.dataready}},setters:{src:function(e){e&&(this.setAttribute("src",e),f.request(this,{url:e,method:"GET"}))},dataready:function(e){this.xtag.dataready=e,this.xtag.request&&this.xtag.request.readyState==4&&e.call(this,this.xtag.request)}}}},typeOf:function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},toArray:function(e){var t=Array.prototype.slice.call(e,0);return t.hasOwnProperty?t:[e]},hasClass:function(e,t){return!!~e.className.split(" ").indexOf(t)},addClass:function(e,t){if(!f.hasClass(e,t)){var n=e.className.split(" ").filter(function(e){return e!=""});n.push(t),e.className=n.join(" ")}return e},removeClass:function(e,t){var n=e.className.split(" ").filter(function(e){return e!=""}),r=n.indexOf(t);return r>=0&&n.splice(r,1),e.className=n.join(" "),e},toggleClass:function(e,t){return f.hasClass(e,t)?f.removeClass(e,t):f.addClass(e,t)},matchSelector:function(e,t){return f._matchSelector.call(e,t)},query:function(e,t){return f.toArray(e.querySelectorAll(t))},queryChildren:function(e,t){var n=null,r="x-"+(new Date).getTime(),i='[xtag-temp-id="'+r+'"] > ',t=i+(t+"").replace(",",","+i,"g");return e.setAttribute("xtag-temp-id",r),n=e.parentNode.querySelectorAll(t),e.removeAttribute("xtag-temp-id"),f.toArray(n)},defineProperty:function(t,n,r,i){return e.documentElement.__defineGetter__?function(e,t,n,r){e["__define"+n[0].toUpperCase()+"etter__"](t,r)}:function(e,t,n,r){var i={configurable:!0};i[n]=r,Object.defineProperty(e,t,i)}}(),clone:function(e){var t=function(){};return t.prototype=e,new t},merge:function(e,t,n){if(f.typeOf(t)=="string")return o(e,t,n);for(var r=1,i=arguments.length;r<i;r++){var s=arguments[r];for(var u in s)o(e,u,s[u])}return e},wrap:function(e,t){return function(){var n=f.toArray(arguments);e.apply(this,n),t.apply(this,n)}},skipTransition:function(e,t,n){var r=s.js+"TransitionDuration";e.style[r]="0.001s",t.call(n),f.addEvent(e,"transitionend",function(){e.style[r]=""})},tagCheck:function(e){return e.nodeName?f.tags[e.nodeName.toLowerCase()]:!1},getOptions:function(e){return f.tagCheck(e)||f.tagOptions},register:function(t,n){f.tagList.push(t),f.tags[t]=f.merge({tagName:t},f.tagOptions,f.applyMixins(n||{})),f.domready&&f.query(e,t).forEach(function(e){r(e)})},extendElement:function(e){if(!e.xtag&&f.tagCheck(e)){e.xtag={};var t=f.getOptions(e);for(var n in t.methods)f.bindMethod(e,n,t.methods[n]);for(var n in t.setters)f.applyAccessor(e,n,"set",t.setters[n]);for(var n in t.getters)f.applyAccessor(e,n,"get",t.getters[n]);f.addEvents(e,t.events),t.content&&(e.innerHTML=t.content),t.onCreate.call(e)}},innerHTML:function(e,t){e.innerHTML=t,f.observer?f.parseMutations(f.observer.takeRecords(),r):r(e)},bindMethod:function(e,t,n){e[t]=function(){return n.apply(e,f.toArray(arguments))}},applyMixins:function(e){return e.mixins&&e.mixins.forEach(function(t){var n=f.mixins[t];for(var r in n)switch(f.typeOf(n[r])){case"function":e[r]=e[r]?f.wrap(e[r],n[r]):n[r];break;case"object":e[r]=f.merge({},n[r],e[r]);break;default:e[r]=n[r]}}),e},applyAccessor:function(e,t,n,r){f.defineProperty(e,t.split(":")[0],n,f.applyPseudos(e,t,r))},applyPseudos:function(e,t,n){var r=n,i={};if(t.match(":")){var s=t.match(/(\w+(?:\([^\)]+\))?)/g);for(var o=s.length-1;o>0;o--)s[o].replace(/(\w*)(?:\(([^\)]*)\))?/,function(n,s,o){var u=r,a=f.pseudos[s],l={key:t,name:s,value:o};a.onAdd&&(i[s]=l),r=function(t){t&&(t.customElement=e);var n=f.toArray(arguments);return n[1]=e,a.listener.apply(this,[l,u,n])}});for(var u in i)f.pseudos[u].onAdd.call(e,i[u],r)}return r},removePseudos:function(e,t,n){t.match(":")&&t.replace(/:(\w*)(?:\(([^\)]*)\))?/g,function(n,r,i){var s=action,o=f.pseudos[r],u={key:t,name:r,value:i};o.onRemove&&o.onRemove.call(e,u,s)})},request:function(r,i){f.clearRequest(r);var s=r.xtag.request||{};r.xtag.request=i;var o=r.xtag.request,u=r.getAttribute("data-callback-key")||"callback=xtag.callbacks.";if(f.fireEvent(r,"beforerequest")===!1)return!1;if(s.url&&!i.update&&s.url.replace(new RegExp("&?("+u+"x[0-9]+)"),"")==r.xtag.request.url)return r.xtag.request=s,!1;r.setAttribute("src",r.xtag.request.url),f.anchor.href=i.url;if(f.anchor.hostname==t.location.hostname)o=f.merge(new XMLHttpRequest,o),o.onreadystatechange=function(){r.setAttribute("data-readystate",o.readyState),o.readyState==4&&o.status<400&&f.requestCallback(r,o)},["error","abort","load"].forEach(function(e){o["on"+e]=function(t){t.request=o,f.fireEvent(r,e,t)}}),o.open(o.method,o.url,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send();else{var a=o.callbackID="x"+(new Date).getTime();r.setAttribute("data-readystate",o.readyState=0),f.callbacks[a]=function(e){o.status=200,o.readyState=4,o.responseText=e,f.requestCallback(r,o),delete f.callbacks[a],f.clearRequest(r)},o.script=e.createElement("script"),o.script.type="text/javascript",o.script.src=i.url=i.url+(~i.url.indexOf("?")?"&":"?")+u+a,o.script.onerror=function(e){r.setAttribute("data-readystate",o.readyState=4),r.setAttribute("data-requeststatus",o.status=400),f.fireEvent(r,"error",e)},n.appendChild(o.script)}r.xtag.request=o},requestCallback:function(e,t){if(t!=e.xtag.request)return f;e.setAttribute("data-readystate",t.readyState),e.setAttribute("data-requeststatus",t.status),f.fireEvent(e,"dataready",{request:t}),e.dataready&&e.dataready.call(e,t)},clearRequest:function(e){var t=e.xtag.request;if(!t)return f;t.script&&~f.toArray(n.children).indexOf(t.script)?n.removeChild(t.script):t.abort&&t.abort()},addEvent:function(e,t,n){var r=t.split(":")[0],i=f.eventMap[r]||[r],s=f.applyPseudos(e,t,n);return i.forEach(function(t){e.addEventListener(t,s,!!~["focus","blur"].indexOf(t))}),s},addEvents:function(e,t){for(var n in t)f.addEvent(e,n,t[n])},removeEvent:function(e,t,n){var r=t.split(":")[0],i=f.eventMap[r]||[r];i.forEach(function(t){e.removeEventListener(t,n)})},fireEvent:function(t,n,r,i){var i=i||{},s=e.createEvent("Event");s.initEvent(n,"bubbles"in i?i.bubbles:!0,"cancelable"in i?i.cancelable:!0),t.dispatchEvent(f.merge(s,r))},parseMutations:function(e,t){var n=[];e.forEach(function(e){var r=e.addedNodes,s=r.length;for(i=0;i<s&&n.indexOf(r[i])==-1;i++)n.push(r[i]),t(r[i],!0)})},observe:function(e,t){if(f.mutation){var n=new f.mutation(function(e){f.parseMutations(e,t)});n.observe(e,{subtree:!0,childList:!0,attributes:!1,characterData:!1}),f.observer=n}else e.addEventListener("DOMNodeInserted",function(e){t(e.target,!0)},!1)}},l=HTMLElement.prototype.setAttribute;(t.HTMLUnknownElement||HTMLElement).prototype.setAttribute=function(e,t,n){!n&&this.xtag&&this.xtag.attributeSetters&&(this[this.xtag.attributeSetters[e]]=t),l.call(this,e,t)};var c=e.createElement;e.createElement=function(e){var t=c.call(this,e);return f.extendElement(t),t},e.readyState=="complete"?h():e.readyState=="interactive"?e.addEventListener("readystatechange",function(e){h()}):e.addEventListener("DOMContentLoaded",function(e){h()},!1),typeof define=="function"&&define.amd?define([],f):t.xtag=f})()