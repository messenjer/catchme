define(["require","zepto","./css-animations"],function(e){function i(e,t,n){return n=n||{},n["-webkit-"+e]=t,n["-moz-"+e]=t,n["-ms-"+e]=t,n["-o-"+e]=t,n[e]=t,n}function s(e,n){e=t(e);var r=["animationend","webkitAnimationEnd","mozanimationend","MSAnimationEnd","oanimationend"];for(var i in r)e.on(r[i],n)}function o(e,t){function n(){t(),e.off(null,n)}s(e,n)}function u(e,t,n,r,s){f(e,i("transform","translateX("+Math.floor(t)+"px)"),i("transform","translateX("+Math.floor(n)+"px)"),r,s)}function a(e,t,n,r,s){f(e,i("transform","translateY("+Math.floor(t)+"px)"),i("transform","translateY("+Math.floor(n)+"px)"),r,s)}function f(e,s,u,a,f){e=t(e);var l=n.create();l.setKeyframe("0%",s),l.setKeyframe("100%",u),e.css(i("animation-duration",a,i("animation-name",l.name,{"z-index":r++}))),o(e,function(){f&&e.css({zIndex:0}),n.remove(l),console.log("ending")})}function l(e,n){t(n).css(i("transition","none",{zIndex:r++}))}function c(e,n){t(n).css(i("transition","none",{zIndex:0}))}function h(e,n){var r=t(e).width(),i=t(n).width();setTimeout(function(){u(e,0,-r,"500ms"),u(n,i,0,"500ms")},0)}function p(e,t){h(t,e)}function d(e,n){var r=t(e).width(),i=t(n).width();setTimeout(function(){u(e,0,r,"500ms"),u(n,-i,0,"500ms")},0)}function v(e,t){d(t,e)}function m(e,n){setTimeout(function(){a(n,-t(n).height(),0,"500ms")},0)}function g(e,n){setTimeout(function(){a(n,0,t(n).height(),"500ms",!0)},0)}function y(e,n){setTimeout(function(){a(n,t(n).height(),0,"500ms")},0)}function b(e,n){setTimeout(function(){a(n,0,-t(n).height(),"500ms",!0)},0)}function w(e,n){var s=t('<div class="anim-background"></div>');s.css({zIndex:r++}),s.insertBefore(n),setTimeout(function(){f(e,i("transform","rotate3d(0, 1, 0, 0deg)"),i("transform","rotate3d(0, 1, 0, 180deg)"),"1s"),f(n,i("transform","rotate3d(0, 1, 0, 180deg)"),i("transform","rotate3d(0, 1, 0, 0deg)"),"1s")},0),o(n,function(){s.remove()})}function E(e,t){w(t,e)}var t=e("zepto"),n=e("./css-animations"),r=100;return{instant:l,instantOut:c,slideLeft:h,slideLeftOut:p,slideRight:d,slideRightOut:v,slideDown:m,slideDownOut:g,slideUp:y,slideUpOut:b,flip:w,flipOut:E,onAnimationEnd:s,onAnimationEndOnce:o}})